LimaCharlie-Tines EDR Automation Project Documentation
1. Project Overview
This project demonstrates how to set up a fully automated Security Orchestration, Automation, and Response (SOAR) system. Using LimaCharlie as the Endpoint Detection and Response (EDR) platform, combined with Tines for orchestrating automated workflows, the system detects LaZagne, a password recovery tool, and triggers alerts in Slack and email. Depending on user input, the system isolates the infected machine.
________________


2. Project Architecture
* LimaCharlie: Acts as the EDR to detect threats.
* Tines: Orchestrates the alerting and decision-making processes.
* Slack: Used as an alert notification channel.
* Email: Additional alert notification channel.
* Windows 10 VM: Configured as a LimaCharlie agent for threat detection.
________________


3. Steps to Setup the EDR Environment
3.1 LimaCharlie Setup
1. Create a LimaCharlie Account: Sign up at LimaCharlie.io.
2. Install LimaCharlie on a Windows 10 VM:
   * Download and install the LimaCharlie agent files on a Windows 10 VM.
   * Configure the VM to act as a LimaCharlie agent, allowing it to monitor for any suspicious activity.


3.2 Detection Rule for LaZagne
1. Download LaZagne: Install the LaZagne tool on the same Windows 10 VM to simulate a red team scenario.
2.   Create a Detection and Response (D&R) Rule:
   * In LimaCharlie, create a rule to detect LaZagne activity (such as processes or file signatures).
   *   Verify that LimaCharlie logs and detects the LaZagne event.


________________


4. Automating the Response Using Tines
4.1 Tines Integration
      1. Set Up Tines:
      * Create an account in Tines.
      * Link Tines with LimaCharlie to automate alert and response workflows.
      2. Create the SOAR Workflow:
      * Build an automation playbook in Tines that sends alerts to Slack and email when LaZagne is detected by LimaCharlie.
      * Include a user decision point: Ask the user whether they want to isolate the infected machine.  
________________


5. Alerting System
5.1 Slack Alerts
         1. Create a Slack Channel: Set up a Slack channel to receive the automated alerts.
         2. Link Slack with Tines: When LaZagne is detected, send detailed alert messages to Slack with the following information:
         * Time of detection
         * Computer name
         * Source IP address
         * Process and command line data
         * A link to Tines for user action
  

5.2 Email Alerts
         1. Configure Email Notifications: Set up an email workflow in Tines to receive alerts along with the details outlined above.
         2. Alert Structure: Email messages include links to Tines where users can choose to isolate the machine or investigate further.


  
________________

6. Incident Response Options
6.1 User Decision to Isolate the Machine
         1. Prompt for Isolation: The Tines workflow asks the user if they wish to isolate the machine.
         * If Yes, LimaCharlie automatically isolates the infected machine.
         * If No, a message is sent to notify the user to investigate further.
         2. Response Update:
         * A confirmation message is sent to both Slack and email, providing the status of the machine (isolated or not isolated).


6.2 Machine Isolation via LimaCharlie
         1. Automated Isolation:
         * If isolation is confirmed, LimaCharlie performs the isolation, cutting off the infected machine from the network.
         2. Isolation Status Update:
         * A message with the isolation status is sent to both Slack and email, notifying the team that the machine is now isolated.
  

________________


7. Testing and Results
After setting up the system, test the integration by running LaZagne on the Windows 10 VM. Observe the following:
         1. Detection of LaZagne by LimaCharlie.
         2. Automated alert generation to Slack and email.
         3. User prompt in Tines asking whether to isolate the machine.
         4. Machine isolation (if selected) and notification of isolation status.
  
  

________________


8. Conclusion
This project highlights how a SOAR system using LimaCharlie and Tines can automate threat detection and incident response, providing real-time alerts and enabling quick decision-making in security operations. The combination of EDR and orchestration ensures a faster and more efficient incident response process, minimizing potential damage from security breaches.
Demo: SOAR-EDR-DEMO 
________________